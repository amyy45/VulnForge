from ftplib import FTP

def validate_ftp_access(target, username, password):
    print("[+] Attempting FTP login for exploit validation")

    try:
        ftp = FTP(target, timeout=10)
        ftp.login(user=username, passwd=password)

        files = ftp.nlst()

        ftp.quit()

        return {
            "service": "ftp",
            "access": "authenticated",
            "files": files[:10]  # limit output
        }

    except Exception as e:
        print(f"[-] FTP access failed: {e}")
        return None
